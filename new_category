# Step 1: Fit GMM on y_train
y_train_np = y_train.values.reshape(-1, 1)   # convert Series to numpy
gmm = GaussianMixture(n_components=2, random_state=0)
labels = gmm.fit_predict(y_train_np)   # cluster assignments (0/1)

# Step 2: Train classifier to predict peak
clf = RandomForestClassifier(n_estimators=200, random_state=0)
clf.fit(X_train, labels)

# Step 3: Train one regressor per peak
reg0 = RandomForestRegressor(n_estimators=200, random_state=0)
reg1 = RandomForestRegressor(n_estimators=200, random_state=0)

reg0.fit(X_train[labels==0], y_train[labels==0])
reg1.fit(X_train[labels==1], y_train[labels==1])